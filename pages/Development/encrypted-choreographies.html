<psk-page title="SecurityContext: Encryption in PrivateSky for encrypted choreographies">
  <psk-toc title="Table of contents"></psk-toc>
  <psk-chapter title="Concepts">
    We proposed the concept of encrypted choreographies as a method to make easy to use cryptography methods with swarms communication.
    <p>Understanding  encrypted choreographies is PrivateSky there are the following concepts:</p>
    <ul>
      <li> SecurityContext is a global variable in $$.SecurityContext offering encryption functionality as part of the swarm execution engine
          <p>The list of functions offered by SecurityContext is:</p>
          <ul> 
            <li>
              getCurrentAgentIdentity(): returns an agent identity  (the main identity in the current Security Context)
            </li>

            <li>
              getSecret(readList, callback): returns a plain text secret extracted from the readList, assuming that the Security Context has access to a private key with witch the secret was encrypted
            </li>
            
             <li>
              shareSecret(secret, list): returns an array of EncryptedSecret elements where each EncryptedSecret contains the secret encrypted with the public key of the agent whose id is specified in list 
            </li>

            <li>
              generateRandom(len): returns a buffer of random bytes of size len
            </li>

            <li>
              sign(digest, writeList, [all,] callback): returns a PSkSignature instance that contains a signature for the digest signed by the first agent known to current security Context.
              If the 'all' argument is true than sign returns an array of PSkSignature objects for all the known agents of the current Security Context.
            </li>
            
            <li>
             verify(pskSignature): returns true if the signature is verifiable using the private key of the agent having the id pskSignature.agentId and false otherwise
            </li>
          </ul>
      </li>

      <li> PskSignature type is a JSON {message, signature, type, agentId}</li>
      <li> EncryptedSecret type contains a JSON {encryptedText, agentId } </li>
      <li> readList type: is an array of encrypted secrets (as EncryptedSecret type)  </li>
      <li> writeList type is an array with agent identities (as strings) </li>
      <li> Declarations of the secure blocks in swarm descriptions</li>
    </ul>

  </psk-chapter>


  <psk-chapter title="Secure blocks in swarm descriptions">
    To be explained
  </psk-chapter>
</psk-page>
